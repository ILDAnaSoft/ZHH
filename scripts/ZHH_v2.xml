<?xml version="1.0" encoding="us-ascii"?>
    <marlin xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://ilcsoft.desy.de/marlin/marlin.xsd">

    <constants>
        <constant name="lcgeo_DIR" value="/cvmfs/ilc.desy.de/sw/x86_64_gcc82_centos7/v02-02-02/lcgeo/v00-16-06" />
        <constant name="DetectorModel" value="ILD_l5_o1_v02" />
        <constant name="CompactFile" value="${lcgeo_DIR}/ILD/compact/${DetectorModel}/${DetectorModel}.xml" />
        <constant name="OutputDirectory" value="output" />
        <constant name="OutputBaseName" value="zhh" />
        <constant name="OutputRootFile" value="${OutputBaseName}.root" />
        <constant name="NumberOfHiggs" value="2" />
        <constant name="NumberOfJets" value="4" />
        <constant name="WhichPreselection" value="llbbbb"/>
        <constant name="ECM" value="500."/>
        <constant name="createRootTree" value="false" />
        <constant name="displayEvent" value="false" />
        <constant name="Verbosity" value="SILENT"/>
    </constants>

    <execute>
        <processor name="InitDD4hep" />
        <processor name="MyAIDAProcessor" />
        <processor name="MyAddNeutralPFOCovMatLite" />
        <!-- <processor name="MyHdecayMode" /> -->

        <processor name="MyFastJetProcessor" />
        <!-- <processor name="MyCheatedMCOverlayRemoval" /> -->
        <processor name="MyThrust"/>
        
        <!--
        For llHH only, run isolated lepton tagging and lepton pairing with BS/FSR recovery
        In this case LCFIPlus must be rerun as the isolated leptons are removed from the PFO collection
        -->
        <processor name="MyIsolatedLeptonTaggingProcessor" />
        <processor name="MyLeptonPairing"/>
        <processor name="JC4FT_ll"/>
        
        <processor name="JC4FT"/>
        <!-- <processor name="MyComprehensivePIDProcessor" /> -->

        <processor name="MyPreSelectionHHll"/>
        <processor name="MyPreSelectionHHvv"/>
        <processor name="MyPreSelectionHHqq"/>
        <processor name="MyFinalStateRecorder"/>
        <!-- <processor name="MyLCIOOutputProcessor"/> -->
    </execute>

    <global>
        <!--parameter name="LCIOInputFiles">/pnfs/desy.de/ilc/prod/ilc/mc-2020/ild/dst-merged/250-SetA/4f_ZZ_hadronic/ILD_l5_o1_v02/v02-02/rv02-02.sv02-02.mILD_l5_o1_v02.E250-SetA.I500062.P4f_zz_h.eL.pR.n000.d_dstm_15122_0.slcio</parameter-->
        <parameter name="LCIOInputFiles">
            <!-- /pnfs/desy.de/ilc/prod/ilc/mc-2020/ild/dst-merged/500-TDR_ws/2f_Z_hadronic/ILD_l5_o1_v02/v02-02-03/00015902/000/rv02-02-03.sv02-02-03.mILD_l5_o1_v02.E500-TDR_ws.I500259.P2f_z_h.eL.pR.n000.d_dstm_15902_0.slcio
            /pnfs/desy.de/ilc/prod/ilc/mc-2020/ild/dst-merged/500-TDR_ws/hh/ILD_l5_o1_v02/v02-02-03/00015747/000/rv02-02-03.sv02-02-03.mILD_l5_o1_v02.E500-TDR_ws.I403009.Pqqhh.eL.pR.n019.d_dstm_15747_156.slcio
            /pnfs/desy.de/ilc/prod/ilc/mc-2020/ild/dst-merged/500-TDR_ws/hh/ILD_l5_o1_v02/v02-02-03/00015747/000/rv02-02-03.sv02-02-03.mILD_l5_o1_v02.E500-TDR_ws.I403020.Pqqqqh.eR.pL.n008.d_dstm_15747_73.slcio -->
            /pnfs/desy.de/ilc/prod/ilc/mc-opt-3/ild/dst-merged/500-TDR_ws/2f_Z_bhabhag/ILD_l5_o1_v02/v02-00-01/rv02-00-01.sv02-00-01.mILD_l5_o1_v02.E500-TDR_ws.I250101.P2f_z_bhabhag.eL.pL.n001.d_dstm_10366_0.slcio
            /pnfs/desy.de/ilc/prod/ilc/mc-opt-3/ild/dst-merged/500-TDR_ws/2f_Z_hadronic/ILD_l5_o1_v02/v02-00-01/rv02-00-01.sv02-00-01.mILD_l5_o1_v02.E500-TDR_ws.I250114.P2f_z_h.eL.pR.n001.d_dstm_10410_0.slcio
            /pnfs/desy.de/ilc/prod/ilc/mc-opt-3/ild/dst-merged/500-TDR_ws/2f_Z_leptonic/ILD_l5_o1_v02/v02-00-01/rv02-00-01.sv02-00-01.mILD_l5_o1_v02.E500-TDR_ws.I250106.P2f_z_l.eL.pR.n001.d_dstm_10255_0.slcio
            /pnfs/desy.de/ilc/prod/ilc/mc-opt-3/ild/dst-merged/500-TDR_ws/2f_Z_nuNg/ILD_l5_o1_v02/v02-00-01/rv02-00-01.sv02-00-01.mILD_l5_o1_v02.E500-TDR_ws.I250130.P2f_z_nung.eL.pR.n001.d_dstm_10589_0.slcio
        </parameter>
        <!-- limit the number of processed records (run+evt): -->
        <!--parameter name="MaxRecordNumber" value="0" /to process all events--> 
        <!--parameter name="MaxRecordNumber" value="1000" /to process 1000 events--> 
        <parameter name="MaxRecordNumber" value="100"/>
        <parameter name="SkipNEvents" value="0" />
        <parameter name="SupressCheck" value="false" />
        <parameter name="GearXMLFile">/cvmfs/ilc.desy.de/sw/ILDConfig/v02-02-02/StandardConfig/production/Gear/gear_ILD_l5_v02.xml</parameter>
        <parameter name="Verbosity" options="DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT">SILENT</parameter>
        <parameter name="RandomSeed" value="1234567890" />
        <parameter name="OutputSteeringFile" value="" />
        <parameter name="AllowToModifyEvent" value="true" />
        <!-- optionally limit the collections that are read from the input file: -->
        <!--parameter name="LCIOReadCollectionNames">MCParticle PandoraPFOs</parameter-->
    </global>

    <processor name="InitDD4hep" type="InitializeDD4hep">
        <!--InitializeDD4hep reads a compact xml file and initializes the DD4hep::LCDD object-->
        <!--Name of the DD4hep compact xml file to load-->
        <parameter name="DD4hepXMLFile" type="string">${CompactFile}</parameter>
        <parameter name="Verbosity" type="string">SILENT</parameter>
    </processor>

    <processor name="MyAIDAProcessor" type="AIDAProcessor">
        <!--Processor that handles AIDA files. Creates on directory per processor.  Processors only need to create and fill the histograms,clouds and tuples. Needs to be the first ActiveProcessor-->
        <!-- compression of output file 0: false >0: true (default) -->
        <parameter name="Compress" type="int">1</parameter>
        <!-- filename without extension-->
        <parameter name="FileName" type="string">${OutputDirectory}/${OutputBaseName}_AIDA</parameter>
        <!-- type of output file root (default) or xml )-->
        <parameter name="FileType" type="string">root</parameter>
        <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
        <!--parameter name="Verbosity" type="string">DEBUG </parameter-->
    </processor>

    <processor name="MyJetConvProcessor" type="JetConvProcessor">
        <!--JetConvProcessor does jet clustering using a PyTorch GNN network and SpectralClustering -->
        <!--Name of the Input MCParticle Collection-->
        <parameter name="MCParticleCollection" type="string" lcioInType="MCParticle">MCParticlesSkimmed</parameter>
        <!--Name of the Input PFO Collection-->
        <parameter name="inputPfoCollection" type="string" lcioInType="RECONSTRUCTEDPARTICLE">PandoraPFOsWithoutIsoLep</parameter>
        <!--Number of jets to reconstruct (default: 2) -->
        <parameter name="nJets" type="int"> 4 </parameter>
        <!--Names of the output jet collection-->
        <parameter name="torchScriptPath" type="string">/nfs/dust/ilc/user/bliewert/jet_training/model_3m/best.pt</parameter>
        <!--Names of the output jet collection-->
        <parameter name="outputJetCollection" type="string" lcioOutType="RECONSTRUCTEDPARTICLE">GraphJets</parameter>
        <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
        <parameter name="Verbosity" type="string">DEBUG</parameter>
    </processor>

    <processor name="MyAddNeutralPFOCovMatLite" type="AddNeutralPFOCovMat">
        <!--Name of the Input PFO Collection-->
        <parameter name="inputPfoCollection" type="string" lcioInType="RECONSTRUCTEDPARTICLE">PandoraPFOs</parameter>
        <!--Names of the Output PFO collection-->
        <parameter name="outputPfoCollection" type="string" lcioOutType="RECONSTRUCTEDPARTICLE">PandoraPFO_updatedNeutralPFOs</parameter>
        <!--true: Neutral PFOs are taken massive, false: Neutral PFOs are taken massless-->
        <parameter name="AssumeNeutralPFOMassive" type="bool">true</parameter>
        <!--true: the cluster energy is interpreted as kinetic energy of PFO, false: the cluster energy is interpreted as momentum magnitude of PFO-->
        <parameter name="isClusterEnergyKinEnergy" type="bool">false</parameter>
        <!--true: Update 4-momentum of PFOs, false: set 4-momentum for PFOs same as input PFO-->
        <parameter name="updatePFO4Momentum" type="bool">false</parameter>
        <!--true: Use (mathematically) true Jacobian for the option E_cluster = |p|, false: for the option E_cluster = |p|, Use the same jacobian as the option E_cluster = E_kinetic-->
        <parameter name="useTrueJacobian" type="bool">false</parameter>
        <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
        <parameter name="Verbosity" type="string">SILENT</parameter>
    </processor>

    <processor name="MyHdecayMode" type="HdecayMode">
        <!--HdecayMode identifies Higgs decay mode and cheats ISR energy-->
        <!--Name of the Input MCParticle Collection-->
        <parameter name="MCParticleCollection" type="string" lcioInType="MCParticle">MCParticlesSkimmed </parameter>
        <!--Number of Higgs decays (default: 2) -->
        <parameter name="nHiggs" type="int"> ${NumberOfHiggs} </parameter>
        <!--Names of the Output Higgs decay mode collection-->
        <parameter name="HdecayModeCollection" type="string" lcioOutType="MCParticle">HdecayMode </parameter>
        <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
        <parameter name="Verbosity" type="string">MESSAGE</parameter>
    </processor>

    <processor name="MySLDecayFinder" type="SLDecayFinder">
        <!--PfoAnalysis analyses output of PandoraPFANew-->
        <!--Names of input pfo collection-->
        <parameter name="PfoCollection" type="string" lcioInType="ReconstructedParticle">PandoraPFOs</parameter>
        <!--Names of mc particle collection-->
        <parameter name="MCParticleCollection" type="string" lcioInType="MCParticle">MCParticlesSkimmed</parameter>
        <!--Names of semi-leptonic decay collection-->
        <parameter name="SemiLeptonicDecays" type="string" lcioInType="MCParticle">SemiLeptonicDecays</parameter>
        <!--Name of the output root file-->
        <!--parameter name="RootFile" type="string"> ${OutputRootFile} </parameter-->
        <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
        <parameter name="Verbosity" type="string">MESSAGE</parameter>
    </processor>

    <processor name="MyFastJetProcessor" type="FastJetProcessor">
        <parameter name="algorithm" type="StringVec">kt_algorithm 1.3</parameter>
        <parameter name="clusteringMode" type="StringVec">ExclusiveNJets 4</parameter>
        <parameter name="recParticleIn" type="string" lcioInType="ReconstructedParticle">PandoraPFOs</parameter>
        <parameter name="jetOut" type="string" lcioOutType="ReconstructedParticle">FastJets4_Precluster</parameter>
        <parameter name="recParticleOut" type="string" lcioOutType="ReconstructedParticle">PFOsWithoutOverlay</parameter>
        <parameter name="storeParticlesInJets" type="bool">true</parameter>
        
        <parameter name="recombinationScheme" type="string">E_scheme</parameter>
        <parameter name="Verbosity" type="string">SILENT</parameter>
    </processor>

    <processor name="MyCheatedMCOverlayRemoval" type="CheatedMCOverlayRemoval">
        <parameter name="RecoParticleCollection" type="string"  lcioInType="ReconstructedParticle">PandoraPFOs</parameter>
        <parameter name="MCParticleCollection" type="string"  lcioInType="MCParticle">MCParticlesSkimmed</parameter>
        <parameter name="RecoMCTruthLink" type="string" lcioInType="LCRelation"> RecoMCTruthLink </parameter>
        <parameter name="MCTruthRecoLink" type="string" lcioInType="LCRelation"> MCTruthRecoLink </parameter>
        <parameter name="OutputPfoCollection" type="string" lcioOutType="ReconstructedParticle">PFOsWithoutOverlay</parameter>
        <parameter name="Verbosity" type="string">SILENT</parameter>
    </processor>

    <processor name="MyTrueJet" type="TrueJet">
        <!-- These are the defaults, probably exactly what you need.-->
        <parameter name="MCParticleCollection" type="string" lcioInType="MCParticle">MCParticlesSkimmed</parameter>
        <parameter name="RecoParticleCollection" type="string"  lcioInType="ReconstructedParticle">PandoraPFOs</parameter>
        <parameter name="RecoMCTruthLinkName" type="string" lcioInType="LCRelation"> RecoMCTruthLink </parameter>
        <parameter name="TrueJets" type="string"  lcioOutType="ReconstructedParticle">TrueJets</parameter>
        <parameter name="FinalColourNeutrals" type="string"  lcioOutType="ReconstructedParticle">FinalColourNeutrals</parameter>
        <parameter name="InitialColourNeutrals" type="string"  lcioOutType="ReconstructedParticle">InitialColourNeutrals</parameter>
        <parameter name="TrueJetPFOLink" type="string" lcioOutType="LCRelation"> TrueJetPFOLink </parameter>
        <parameter name="TrueJetMCParticleLink" type="string" lcioOutType="LCRelation">TrueJetMCParticleLink </parameter>
        <parameter name="FinalElementonLink" type="string" lcioOutType="LCRelation">FinalElementonLink</parameter>
        <parameter name="InitialElementonLink" type="string" lcioOutType="LCRelation">InitialElementonLink</parameter>
        <parameter name="FinalColourNeutralLink" type="string" lcioOutType="LCRelation">FinalColourNeutralLink</parameter>
        <parameter name="InitialColourNeutralLink" type="string" lcioOutType="LCRelation">InitialColourNeutralLink</parameter>
        <parameter name="Verbosity" type="string">SILENT</parameter>
    </processor>

    <processor name="MyThrust" type="ThrustReconstruction">
        <!--Calculates thrust axis and thrust value of event using different algorithms-->  <!--Name of collection of reconstructed particles used for thrust reconstruction-->
        <parameter name="inputCollectionName" type="string" lcioInType="ReconstructedParticle"> PFOsWithoutOverlay </parameter>
        <!--parameter name="inputCollectionName" type="string" lcioInType="ReconstructedParticle"> PandoraPFOsNew </parameter-->
        <!--Type of thrust reconstruction algorithm to be used:  1 : Tasso algorithm  2 : JetSet algorithm-->
        <parameter name="typeOfThrustFinder" type="int"> 2 </parameter>
        <parameter name="Verbosity" type="string">SILENT</parameter>
    </processor>

    <processor name="MyIsolatedLeptonTaggingProcessor" type="IsolatedLeptonTaggingProcessor">
        <!--IsolatedLeptonTaggingProcessor does whatever it does ...-->
        <!--cosine of the larger cone-->
        <parameter name="CosConeLarge" type="float">0.95</parameter>
        <!--cosine of the smaller cone-->
        <parameter name="CosConeSmall" type="float">0.98</parameter>
        <!--Cut on the mva output of isolated electron selection-->
        <parameter name="CutOnTheISOElectronMVA" type="float">0.5</parameter>
        <!--Cut on the mva output of isolated muon selection-->
        <parameter name="CutOnTheISOMuonMVA" type="float">0.7</parameter>
        <!--Directory of Weights for the Isolated Electron MVA Classification-->
        <parameter name="DirOfISOElectronWeights" type="string">/cvmfs/ilc.desy.de/sw/x86_64_gcc82_centos7/v02-02-02/MarlinReco/v01-31/Analysis/IsolatedLeptonTagging/example/isolated_electron_weights</parameter>
        <!--Directory of Weights for the Isolated Muon MVA Classification-->
        <parameter name="DirOfISOMuonWeights" type="string">/cvmfs/ilc.desy.de/sw/x86_64_gcc82_centos7/v02-02-02/MarlinReco/v01-31/Analysis/IsolatedLeptonTagging/example/isolated_muon_weights_woYoke </parameter>
        <!--Name of the PandoraPFOs collection-->
        <parameter name="InputPandoraPFOsCollection" type="string" lcioInType="ReconstructedParticle">PFOsWithoutOverlay</parameter>
        <!--Name of the Primary Vertex collection-->
        <parameter name="InputPrimaryVertexCollection" type="string" lcioInType="Vertex">PrimaryVertex</parameter>
        <!--flag to select one most like isolated lepton-->
        <parameter name="IsSelectingOneIsoLep" type="bool">false</parameter>
        <!--Maximum d0 significance for electron-->
        <parameter name="MaxD0SigForElectron" type="float">50</parameter>
        <!--Maximum D0 significance for muon-->
        <parameter name="MaxD0SigForMuon" type="float">20</parameter>
        <!--Maximum ratio of energy in calorimeters over momentum for electron-->
        <parameter name="MaxEOverPForElectron" type="float">1.3</parameter>
        <!--Maximum ratio of energy in calorimeters over momentum for muon-->
        <parameter name="MaxEOverPForMuon" type="float">0.3</parameter>
        <!--Maximum Z0 significance for electron-->
        <parameter name="MaxZ0SigForElectron" type="float">50</parameter>
        <!--Maximum Z0 significance for muon-->
        <parameter name="MaxZ0SigForMuon" type="float">20</parameter>
        <!--minimum ratio of energy in calorimeters over momentum for electron-->
        <parameter name="MinEOverPForElectron" type="float">0.5</parameter>
        <!--minimum ratio of energy in ecal over energy in ecal+hcal-->
        <parameter name="MinEecalOverTotEForElectron" type="float">0.9</parameter>
        <!--Minimum energy in yoke for electron-->
        <parameter name="MinEyokeForMuon" type="float">1.2</parameter>
        <!--Minimum momentum for electron-->
        <parameter name="MinPForElectron" type="float">5</parameter>
        <!--Minimum momentum for muon-->
        <parameter name="MinPForMuon" type="float">5</parameter>
        <!--Name of collection with the selected isolated lepton-->
        <parameter name="OutputIsoLeptonsCollection" type="string" lcioOutType="ReconstructedParticle">ISOLeptons</parameter>
        <!--Name of the new PFOs collection without isolated lepton-->
        <parameter name="OutputPFOsWithoutIsoLepCollection" type="string" lcioOutType="ReconstructedParticle">PandoraPFOsWithoutIsoLep</parameter>
        <!--use yoke for muon ID-->
        <parameter name="UseYokeForMuonID" type="bool">false</parameter>
        <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
        <parameter name="Verbosity" type="string">SILENT</parameter>
    </processor>

    <processor name="MyLeptonPairing" type="LeptonPairing">
        <parameter name="ISOLeptons" type="string" lcioInType="ReconstructedParticle">ISOLeptons</parameter>
        <parameter name="PandoraPFOsWithoutIsoLep" type="string" lcioInType="ReconstructedParticle">PandoraPFOsWithoutIsoLep</parameter>
        <parameter name="LeptonPair" type="string" lcioOutType="ReconstructedParticle">LeptonPair</parameter>
        <parameter name="PandoraPFOsWithoutLepPair" type="string" lcioOutType="ReconstructedParticle">PandoraPFOsWithoutLepPair</parameter>
        <parameter name="fillRootTree" type="bool">true</parameter>
        <parameter name="RootFile" type="string">${OutputDirectory}/${OutputBaseName}_LeptonPairing.root</parameter>
        <parameter name="Verbosity" type="string">SILENT</parameter>
    </processor>

    <processor name="JC4FT" type="LcfiplusProcessor">
        <!-- run primary and secondary vertex finders -->
        <parameter name="Algorithms" type="stringVec"> JetClustering JetVertexRefiner FlavorTag ReadMVA </parameter>
        <parameter name="Verbosity" type="string">SILENT</parameter>

        <!-- general parameters -->
        <parameter name="PFOCollection" type="string" value="PFOsWithoutOverlay" /> <!-- input PFO collection -->
        <parameter name="UseMCP" type="int" value="0" /> <!-- MC info not used -->
        <parameter name="MCPCollection" type="string" value="" /> <!-- not used -->
        <parameter name="MCPFORelation" type="string" value="" /> <!-- not used -->
        <parameter name="ReadSubdetectorEnergies" type="int" value="1"/> <!-- true for ILD -->
        <parameter name="UpdateVertexRPDaughters" type="int" value="0"/> <!-- false for non-updative PandoraPFOs -->
        <parameter name="TrackHitOrdering" type="int" value="1"/> <!-- Track hit ordering: 0=ILD-LOI,SID-DBD, 1=ILD-DBD -->
        <parameter name="PrintEventNumber" type="int" value="100"/> <!-- 0 for not printing event number, n for printing every n events -->

        <!-- jet clustering parameters -->
        <parameter name="JetClustering.PrimaryVertexCollectionName" type="string" value="PrimaryVertex" />
        <parameter name="JetClustering.InputVertexCollectionName" type="string" value="BuildUpVertex" /> <!-- vertex collections to be used in JC -->
        <parameter name="JetClustering.OutputJetCollectionName" type="stringVec" value="VertexJets" /> <!-- output collection name, may be multiple -->
        <parameter name="JetClustering.NJetsRequested" type="intVec">${NumberOfJets}</parameter> <!-- Multiple NJets can be specified -->
        <parameter name="JetClustering.YCut" type="doubleVec" value="0." /> <!-- specify 0 if not used -->

        <parameter name="JetClustering.JetAlgorithm" type="string" value="DurhamVertex" /> <!-- jet algorithm -->
        <parameter name="JetClustering.UseBeamJets" type="int" value="0" /> <!-- beam jet rejection -->
        <!--parameter name="JetClustering.RParameter" type="float" value="1.0" /--> <!-- kt, Valencia -->
        <!--parameter name="JetClustering.AlphaParameter" type="float" value="1.3" /--> <!-- Durham beam rejection -->
        <!--parameter name="JetClustering.BetaParameter" type="float" value="1.0" /--> <!-- Valencia -->
        <!--parameter name="JetClustering.GammaParameter" type="float" value="1.0" /--> <!-- Valencia -->

        <parameter name="JetClustering.UseMuonID" type="int" value="1" /> <!-- jet-muon ID for jet clustering -->
        <parameter name="JetClustering.MuonIDExternal" type="int" value="0" /> <!-- true to use LikelihoodPID, false for good-old simple one -->
        <parameter name="JetClustering.MuonIDMinimumD0Significance" type="double" value="5." /> <!-- min D0 significance -->
        <parameter name="JetClustering.MuonIDMinimumZ0Significance" type="double" value="5." /> <!-- min Z0 significance -->
        <parameter name="JetClustering.MuonIDMaximum3DImpactParameter" type="double" value="5." /> <!-- max 3D significance -->
        <parameter name="JetClustering.MuonIDMinimumProbability" type="double" value="0.5" /> <!-- min PID probability, only for external -->

        <parameter name="JetClustering.VertexSelectionMinimumDistance" type="double" value="0.3" /> <!-- in mm -->
        <parameter name="JetClustering.VertexSelectionMaximumDistance" type="double" value="30." /> <!-- in mm -->
        <parameter name="JetClustering.VertexSelectionK0MassWidth" type="double" value="0.02" /> <!-- in GeV -->
        <parameter name="JetClustering.YAddedForJetVertexVertex" type="double" value="100"/> <!-- add penalty for combining vertices -->
        <parameter name="JetClustering.YAddedForJetLeptonVertex" type="double" value="100"/> <!-- add penalty for combining lepton and vertex -->
        <parameter name="JetClustering.YAddedForJetLeptonLepton" type="double" value="100"/> <!-- add penalty for combining leptons -->

        <parameter name="JetVertexRefiner.InputJetCollectionName" type="string" value="VertexJets" />
        <parameter name="JetVertexRefiner.OutputJetCollectionName" type="string" value="RefinedJets" />
        <parameter name="JetVertexRefiner.PrimaryVertexCollectionName" type="string" value="PrimaryVertex" />
        <parameter name="JetVertexRefiner.InputVertexCollectionName" type="string" value="BuildUpVertex" />
        <parameter name="JetVertexRefiner.V0VertexCollectionName" type="string" value="BuildUpVertex_V0" />
        <parameter name="JetVertexRefiner.OutputVertexCollectionName" type="string" value="RefinedVertex" />

        <parameter name="JetVertexRefiner.MinPosSingle" type="double" value="0.3" />
        <parameter name="JetVertexRefiner.MaxPosSingle" type="double" value="30." />
        <parameter name="JetVertexRefiner.MinEnergySingle" type="double" value="1." />
        <parameter name="JetVertexRefiner.MaxAngleSingle" type="double" value="0.5" />
        <parameter name="JetVertexRefiner.MaxSeparationPerPosSingle" type="double" value="0.1" />
        <parameter name="JetVertexRefiner.mind0sigSingle" type="double" value="5." />
        <parameter name="JetVertexRefiner.minz0sigSingle" type="double" value="5." />
        <parameter name="JetVertexRefiner.OneVertexProbThreshold" type="double" value="0.001" />
        <parameter name="JetVertexRefiner.MaxCharmFlightLengthPerJetEnergy" type="double" value="0.1" />

        <!-- FlavorTag parameters -->
        <parameter name="PrimaryVertexCollectionName" type="string" value="PrimaryVertex" />
        <parameter name="FlavorTag.JetCollectionName" type="string" value="RefinedJets" />
        <parameter name="MakeNtuple.AuxiliaryInfo" type="int" value="-1" />

        <!--parameter name="FlavorTag.WeightsDirectory" type="string" value="/afs/desy.de/user/s/skawada/sonas_work/mini-DST/lcfiweights"/--> <!-- e.g. lcfiweights/lcfiweights_6q500_v04_p00_ildl5 -->
        <!--parameter name="FlavorTag.WeightsPrefix" type="string" value="6q500_v04_p00_ildl5" /--> <!-- e.g. 6q500_v04_p00_ildl5 -->
        <parameter name="FlavorTag.WeightsDirectory" type="string" value="/afs/desy.de/user/b/bliewert/public/ILCSoft/ILDConfig/LCFIPlusConfig/lcfiweights"/>
        <parameter name="FlavorTag.WeightsPrefix" type="string" value="6q500_v04_p00_ildl5" />
        <parameter name="FlavorTag.BookName" type="string" value="bdt" />
        <parameter name="FlavorTag.PIDAlgo" type="string" value="lcfiplus" />
        <!--parameter name="FlavorTag.D0ProbFileName" type="string" value="/afs/desy.de/user/s/skawada/sonas_work/mini-DST/vtxprob/d0probv2_ildl5_6q500.root"/--> <!-- vtxprob/d0probv2_ildl5_6q500.root -->
        <!--parameter name="FlavorTag.Z0ProbFileName" type="string" value="/afs/desy.de/user/s/skawada/sonas_work/mini-DST/vtxprob/z0probv2_ildl5_6q500.root"/--> <!-- vtxprob/z0probv2_ildl5_6q500.root -->
        <parameter name="FlavorTag.D0ProbFileName" type="string" value="/cvmfs/ilc.desy.de/sw/ILDConfig/v02-02-01/LCFIPlusConfig/vtxprob/d0probv2_ildl5_6q500.root"/>
        <parameter name="FlavorTag.Z0ProbFileName" type="string" value="/cvmfs/ilc.desy.de/sw/ILDConfig/v02-02-01/LCFIPlusConfig/vtxprob/z0probv2_ildl5_6q500.root"/>

        <parameter name="FlavorTag.CategoryDefinition1" type="string">nvtx==0</parameter>
        <parameter name="FlavorTag.CategoryPreselection1" type="string">trk1d0sig!=0</parameter>
        <parameter name="FlavorTag.CategoryVariables1" type="stringVec">
        trk1d0sig trk2d0sig trk1z0sig trk2z0sig trk1pt_jete trk2pt_jete jprobr25sigma jprobz25sigma
        d0bprob2 d0cprob2 d0qprob2 z0bprob2 z0cprob2 z0qprob2 nmuon nelectron trkmass
        </parameter>
        <parameter name="FlavorTag.CategorySpectators1" type="stringVec">
        aux nvtx
        </parameter>

        <parameter name="FlavorTag.CategoryDefinition2" type="string">nvtx==1&&nvtxall==1</parameter>
        <parameter name="FlavorTag.CategoryPreselection2" type="string">trk1d0sig!=0</parameter>
        <parameter name="FlavorTag.CategoryVariables2" type="stringVec">
        trk1d0sig trk2d0sig trk1z0sig trk2z0sig trk1pt_jete trk2pt_jete jprobr2 jprobz2
        vtxlen1_jete vtxsig1_jete vtxdirang1_jete vtxmom1_jete vtxmass1 vtxmult1 vtxmasspc vtxprob
        d0bprob2 d0cprob2 d0qprob2 z0bprob2 z0cprob2 z0qprob2
        trkmass nelectron nmuon
        </parameter>
        <parameter name="FlavorTag.CategorySpectators2" type="stringVec">
        aux nvtx
        </parameter>

        <parameter name="FlavorTag.CategoryDefinition3" type="string">nvtx==1&&nvtxall==2</parameter>
        <parameter name="FlavorTag.CategoryPreselection3" type="string">trk1d0sig!=0</parameter>
        <parameter name="FlavorTag.CategoryVariables3" type="stringVec">
        trk1d0sig trk2d0sig trk1z0sig trk2z0sig trk1pt_jete trk2pt_jete jprobr2 jprobz2
        vtxlen1_jete vtxsig1_jete vtxdirang1_jete vtxmom1_jete vtxmass1 vtxmult1 vtxmasspc vtxprob
        1vtxprob vtxlen12all_jete vtxmassall
        </parameter>
        <parameter name="FlavorTag.CategorySpectators3" type="stringVec">
        aux nvtx
        </parameter>

        <parameter name="FlavorTag.CategoryDefinition4" type="string">nvtx>=2</parameter>
        <parameter name="FlavorTag.CategoryPreselection4" type="string">trk1d0sig!=0</parameter>
        <parameter name="FlavorTag.CategoryVariables4" type="stringVec">
        trk1d0sig trk2d0sig trk1z0sig trk2z0sig trk1pt_jete trk2pt_jete jprobr2 jprobz2
        vtxlen1_jete vtxsig1_jete vtxdirang1_jete vtxmom1_jete vtxmass1 vtxmult1 vtxmasspc vtxprob
        vtxlen2_jete vtxsig2_jete vtxdirang2_jete vtxmom2_jete vtxmass2 vtxmult2
        vtxlen12_jete vtxsig12_jete vtxdirang12_jete vtxmom_jete vtxmass vtxmult
        1vtxprob
        </parameter>
        <parameter name="FlavorTag.CategorySpectators4" type="stringVec">
        aux nvtx
        </parameter>
    </processor>

    <processor name="JC4FT_ll" type="LcfiplusProcessor">
        <!-- run primary and secondary vertex finders -->
        <parameter name="Algorithms" type="stringVec"> JetClustering JetVertexRefiner FlavorTag ReadMVA </parameter>
        <parameter name="Verbosity" type="string">SILENT</parameter>

        <!-- general parameters -->
        <parameter name="PFOCollection" type="string" value="PandoraPFOsWithoutLepPair" /> <!-- input PFO collection -->
        <parameter name="UseMCP" type="int" value="0" /> <!-- MC info not used -->
        <parameter name="MCPCollection" type="string" value="" /> <!-- not used -->
        <parameter name="MCPFORelation" type="string" value="" /> <!-- not used -->
        <parameter name="ReadSubdetectorEnergies" type="int" value="1"/> <!-- true for ILD -->
        <parameter name="UpdateVertexRPDaughters" type="int" value="0"/> <!-- false for non-updative PandoraPFOs -->
        <parameter name="TrackHitOrdering" type="int" value="1"/> <!-- Track hit ordering: 0=ILD-LOI,SID-DBD, 1=ILD-DBD -->
        <parameter name="PrintEventNumber" type="int" value="100"/> <!-- 0 for not printing event number, n for printing every n events -->

        <!-- jet clustering parameters -->
        <parameter name="JetClustering.PrimaryVertexCollectionName" type="string" value="PrimaryVertex" />
        <parameter name="JetClustering.InputVertexCollectionName" type="string" value="BuildUpVertex" /> <!-- vertex collections to be used in JC -->
        <parameter name="JetClustering.OutputJetCollectionName" type="stringVec" value="VertexJets_ll" /> <!-- output collection name, may be multiple -->
        <parameter name="JetClustering.NJetsRequested" type="intVec">${NumberOfJets}</parameter> <!-- Multiple NJets can be specified -->
        <parameter name="JetClustering.YCut" type="doubleVec" value="0." /> <!-- specify 0 if not used -->

        <parameter name="JetClustering.JetAlgorithm" type="string" value="DurhamVertex" /> <!-- jet algorithm -->
        <parameter name="JetClustering.UseBeamJets" type="int" value="0" /> <!-- beam jet rejection -->
        <!--parameter name="JetClustering.RParameter" type="float" value="1.0" /--> <!-- kt, Valencia -->
        <!--parameter name="JetClustering.AlphaParameter" type="float" value="1.3" /--> <!-- Durham beam rejection -->
        <!--parameter name="JetClustering.BetaParameter" type="float" value="1.0" /--> <!-- Valencia -->
        <!--parameter name="JetClustering.GammaParameter" type="float" value="1.0" /--> <!-- Valencia -->

        <parameter name="JetClustering.UseMuonID" type="int" value="1" /> <!-- jet-muon ID for jet clustering -->
        <parameter name="JetClustering.MuonIDExternal" type="int" value="0" /> <!-- true to use LikelihoodPID, false for good-old simple one -->
        <parameter name="JetClustering.MuonIDMinimumD0Significance" type="double" value="5." /> <!-- min D0 significance -->
        <parameter name="JetClustering.MuonIDMinimumZ0Significance" type="double" value="5." /> <!-- min Z0 significance -->
        <parameter name="JetClustering.MuonIDMaximum3DImpactParameter" type="double" value="5." /> <!-- max 3D significance -->
        <parameter name="JetClustering.MuonIDMinimumProbability" type="double" value="0.5" /> <!-- min PID probability, only for external -->

        <parameter name="JetClustering.VertexSelectionMinimumDistance" type="double" value="0.3" /> <!-- in mm -->
        <parameter name="JetClustering.VertexSelectionMaximumDistance" type="double" value="30." /> <!-- in mm -->
        <parameter name="JetClustering.VertexSelectionK0MassWidth" type="double" value="0.02" /> <!-- in GeV -->
        <parameter name="JetClustering.YAddedForJetVertexVertex" type="double" value="100"/> <!-- add penalty for combining vertices -->
        <parameter name="JetClustering.YAddedForJetLeptonVertex" type="double" value="100"/> <!-- add penalty for combining lepton and vertex -->
        <parameter name="JetClustering.YAddedForJetLeptonLepton" type="double" value="100"/> <!-- add penalty for combining leptons -->

        <parameter name="JetVertexRefiner.InputJetCollectionName" type="string" value="VertexJets" />
        <parameter name="JetVertexRefiner.OutputJetCollectionName" type="string" value="RefinedJets_ll" />
        <parameter name="JetVertexRefiner.PrimaryVertexCollectionName" type="string" value="PrimaryVertex" />
        <parameter name="JetVertexRefiner.InputVertexCollectionName" type="string" value="BuildUpVertex" />
        <parameter name="JetVertexRefiner.V0VertexCollectionName" type="string" value="BuildUpVertex_V0" />
        <parameter name="JetVertexRefiner.OutputVertexCollectionName" type="string" value="RefinedVertex_ll" />

        <parameter name="JetVertexRefiner.MinPosSingle" type="double" value="0.3" />
        <parameter name="JetVertexRefiner.MaxPosSingle" type="double" value="30." />
        <parameter name="JetVertexRefiner.MinEnergySingle" type="double" value="1." />
        <parameter name="JetVertexRefiner.MaxAngleSingle" type="double" value="0.5" />
        <parameter name="JetVertexRefiner.MaxSeparationPerPosSingle" type="double" value="0.1" />
        <parameter name="JetVertexRefiner.mind0sigSingle" type="double" value="5." />
        <parameter name="JetVertexRefiner.minz0sigSingle" type="double" value="5." />
        <parameter name="JetVertexRefiner.OneVertexProbThreshold" type="double" value="0.001" />
        <parameter name="JetVertexRefiner.MaxCharmFlightLengthPerJetEnergy" type="double" value="0.1" />

        <!-- FlavorTag parameters -->
        <parameter name="PrimaryVertexCollectionName" type="string" value="PrimaryVertex" />
        <parameter name="FlavorTag.JetCollectionName" type="string" value="RefinedJets" />
        <parameter name="MakeNtuple.AuxiliaryInfo" type="int" value="-1" />

        <!--parameter name="FlavorTag.WeightsDirectory" type="string" value="/afs/desy.de/user/s/skawada/sonas_work/mini-DST/lcfiweights"/--> <!-- e.g. lcfiweights/lcfiweights_6q500_v04_p00_ildl5 -->
        <!--parameter name="FlavorTag.WeightsPrefix" type="string" value="6q500_v04_p00_ildl5" /--> <!-- e.g. 6q500_v04_p00_ildl5 -->
        <parameter name="FlavorTag.WeightsDirectory" type="string" value="/afs/desy.de/user/b/bliewert/public/ILCSoft/ILDConfig/LCFIPlusConfig/lcfiweights"/>
        <parameter name="FlavorTag.WeightsPrefix" type="string" value="6q500_v04_p00_ildl5" />
        <parameter name="FlavorTag.BookName" type="string" value="bdt" />
        <parameter name="FlavorTag.PIDAlgo" type="string" value="lcfiplus" />
        <!--parameter name="FlavorTag.D0ProbFileName" type="string" value="/afs/desy.de/user/s/skawada/sonas_work/mini-DST/vtxprob/d0probv2_ildl5_6q500.root"/--> <!-- vtxprob/d0probv2_ildl5_6q500.root -->
        <!--parameter name="FlavorTag.Z0ProbFileName" type="string" value="/afs/desy.de/user/s/skawada/sonas_work/mini-DST/vtxprob/z0probv2_ildl5_6q500.root"/--> <!-- vtxprob/z0probv2_ildl5_6q500.root -->
        <parameter name="FlavorTag.D0ProbFileName" type="string" value="/cvmfs/ilc.desy.de/sw/ILDConfig/v02-02-01/LCFIPlusConfig/vtxprob/d0probv2_ildl5_6q500.root"/>
        <parameter name="FlavorTag.Z0ProbFileName" type="string" value="/cvmfs/ilc.desy.de/sw/ILDConfig/v02-02-01/LCFIPlusConfig/vtxprob/z0probv2_ildl5_6q500.root"/>

        <parameter name="FlavorTag.CategoryDefinition1" type="string">nvtx==0</parameter>
        <parameter name="FlavorTag.CategoryPreselection1" type="string">trk1d0sig!=0</parameter>
        <parameter name="FlavorTag.CategoryVariables1" type="stringVec">
        trk1d0sig trk2d0sig trk1z0sig trk2z0sig trk1pt_jete trk2pt_jete jprobr25sigma jprobz25sigma
        d0bprob2 d0cprob2 d0qprob2 z0bprob2 z0cprob2 z0qprob2 nmuon nelectron trkmass
        </parameter>
        <parameter name="FlavorTag.CategorySpectators1" type="stringVec">
        aux nvtx
        </parameter>

        <parameter name="FlavorTag.CategoryDefinition2" type="string">nvtx==1&&nvtxall==1</parameter>
        <parameter name="FlavorTag.CategoryPreselection2" type="string">trk1d0sig!=0</parameter>
        <parameter name="FlavorTag.CategoryVariables2" type="stringVec">
        trk1d0sig trk2d0sig trk1z0sig trk2z0sig trk1pt_jete trk2pt_jete jprobr2 jprobz2
        vtxlen1_jete vtxsig1_jete vtxdirang1_jete vtxmom1_jete vtxmass1 vtxmult1 vtxmasspc vtxprob
        d0bprob2 d0cprob2 d0qprob2 z0bprob2 z0cprob2 z0qprob2
        trkmass nelectron nmuon
        </parameter>
        <parameter name="FlavorTag.CategorySpectators2" type="stringVec">
        aux nvtx
        </parameter>

        <parameter name="FlavorTag.CategoryDefinition3" type="string">nvtx==1&&nvtxall==2</parameter>
        <parameter name="FlavorTag.CategoryPreselection3" type="string">trk1d0sig!=0</parameter>
        <parameter name="FlavorTag.CategoryVariables3" type="stringVec">
        trk1d0sig trk2d0sig trk1z0sig trk2z0sig trk1pt_jete trk2pt_jete jprobr2 jprobz2
        vtxlen1_jete vtxsig1_jete vtxdirang1_jete vtxmom1_jete vtxmass1 vtxmult1 vtxmasspc vtxprob
        1vtxprob vtxlen12all_jete vtxmassall
        </parameter>
        <parameter name="FlavorTag.CategorySpectators3" type="stringVec">
        aux nvtx
        </parameter>

        <parameter name="FlavorTag.CategoryDefinition4" type="string">nvtx>=2</parameter>
        <parameter name="FlavorTag.CategoryPreselection4" type="string">trk1d0sig!=0</parameter>
        <parameter name="FlavorTag.CategoryVariables4" type="stringVec">
        trk1d0sig trk2d0sig trk1z0sig trk2z0sig trk1pt_jete trk2pt_jete jprobr2 jprobz2
        vtxlen1_jete vtxsig1_jete vtxdirang1_jete vtxmom1_jete vtxmass1 vtxmult1 vtxmasspc vtxprob
        vtxlen2_jete vtxsig2_jete vtxdirang2_jete vtxmom2_jete vtxmass2 vtxmult2
        vtxlen12_jete vtxsig12_jete vtxdirang12_jete vtxmom_jete vtxmass vtxmult
        1vtxprob
        </parameter>
        <parameter name="FlavorTag.CategorySpectators4" type="stringVec">
        aux nvtx
        </parameter>
    </processor>

    <!--
    <processor name="MyComprehensivePIDProcessor" type="ComprehensivePIDProcessor">
        <parameter name="PFOCollection" type="string" value="PandoraPFOs"/>
        <parameter name="RecoMCTruthLink" type="string" value="RecoMCTruthLink"/>
        
        <parameter name="modeExtract" type="bool" value="true" />
        <parameter name="modeTrain"   type="bool" value="true"/>
        <parameter name="modeInfer"   type="bool" value="false"/>

        <parameter name="TTreeFileName" type="string" value="TTreeFile.root"/>
        <parameter name="reffile" type="string" value="Ref.12bins.txt"/>
        <parameter name="signalPDGs" type="FloatVec"  value="11 13 211 321 2212"/>
        <parameter name="backgroundPDGs" type="FloatVec"  value=""/>
        <parameter name="plotFolder" type="string" value="."/>
        <parameter name="fileFormat" type="string" value=".png"/>
        
        <parameter name="momMin" type="float" value="1"/>
        <parameter name="momMax" type="float" value="100"/>
        <parameter name="momLog" type="bool" value="true"/>
        <parameter name="momNBins" type="float" value="12"/>

        <parameter name="cutD0" type="float" value="0"/>
        <parameter name="cutZ0" type="float" value="0"/>
        <parameter name="cutLamMin" type="float" value="0"/>
        <parameter name="cutLamMax" type="float" value="0"/>
        <parameter name="cutNTracksMin" type="int" value="1"/>
        <parameter name="cutNTracksMax" type="int" value="-1"/>
        
        <parameter name="inputAlgoSpecs" type="StringVec">
        dEdx_RCD
        TOF:TOF50
        Pandora
        </parameter>

        <parameter name="dEdx.F" type="FloatVec"  value="1 2 3"/>
        <parameter name="dEdx.S" type="StringVec" value="a b c"/>
        
        <parameter name= "TOF0.S" type="StringVec" value="TOFEstimators0ps" />
        <parameter name="TOF10.S" type="StringVec" value="TOFEstimators10ps"/>
        <parameter name="TOF50.S" type="StringVec" value="TOFEstimators50ps"/>
        
        <parameter name="dEdx_RCD.F" type="FloatVec">
        -1.28883368e-02   2.72959919e+01   1.10560871e+01 -1.74534200e+00  -9.84887586e-07
        6.49143971e-02   1.55775592e+03   9.31848047e+08  2.32201725e-01   2.50492066e-04
        6.54955215e-02   8.26239081e+04   1.92933904e+07  2.52743206e-01   2.26657525e-04
        7.52235689e-02   1.59710415e+04   1.79625604e+06  3.15315795e-01   2.30414997e-04
        7.92251260e-02   6.38129720e+04   3.82995071e+04  2.80793601e-01   7.14371743e-04
        1
        </parameter>

        <parameter name="trainModelSpecs" type="StringVec">
        TMVA_BDT_MC:TMVA_BDT_MC_12bins
        </parameter>
        <parameter name="trainingObservables" type="StringVec"> </parameter>

        <parameter name="TMVA_BDT_MC_12bins.S" type="StringVec">
        !V:!Silent:Color:DrawProgressBar:Transformations=I;D;P;G,D:AnalysisType=multiclass
        SplitMode=Random:NormMode=NumEvents:!V
        !H:!V:NTrees=100:BoostType=Grad:Shrinkage=0.10:UseBaggedBoost:BaggedSampleFraction=0.50:nCuts=20:MaxDepth=3
        dEdx_RCD_piDis>-900&&dEdx_RCD_kaDis>-900
        </parameter>
        
    </processor>
    -->

    <processor name="MyPreSelectionHHll" type="PreSelection">
        <!--MyPreSelection identified events that have passed the preselection-->
        <!--Name of the input collections-->
        <parameter name="isolatedeptonCollection" type="string" lcioInType="ReconstructedParticle">ISOLeptons</parameter>
        <parameter name="LepPairCollection" type="string" lcioInType="ReconstructedParticle">LeptonPair</parameter>
        <parameter name="HiggsCollection" type="string" lcioOutType="ReconstructedParticle">HiggsPair</parameter>
        <parameter name="PreSelectionCollection" type="string" lcioOutType="ReconstructedParticle">PreSelectionHHll</parameter>
        <parameter name="isPassed" type="string" lcioOutType="ReconstructedParticle">isPassedHHll</parameter>
        <parameter name="JetCollectionName" type="string" lcioInType="ReconstructedParticle">RefinedJets_ll</parameter>
        <parameter name="inputPfoCollection" type="string" lcioInType="ReconstructedParticle">PandoraPFOs</parameter>
        <!--Parameters for preselection -->
        <!--predefined preselection available for llbbbb, vvbbbb, and qqbbbb-->
        <parameter name="whichPreselection"> llbbbb </parameter>
        <parameter name="ECM" type="float"> ${ECM} </parameter>

        <parameter name="outputFilename" type="string">${OutputDirectory}/${OutputBaseName}_PreSelection_llHH.root</parameter>
        <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
        <parameter name="Verbosity" type="string">MESSAGE</parameter>
    </processor>

    <processor name="MyPreSelectionHHvv" type="PreSelection">
        <!--MyPreSelection identified events that have passed the preselection-->
        <!--Name of the input collections-->
        <parameter name="isolatedeptonCollection" type="string" lcioInType="ReconstructedParticle">ISOLeptons</parameter>
        <parameter name="LepPairCollection" type="string" lcioInType="ReconstructedParticle">LeptonPair</parameter>
        <parameter name="HiggsCollection" type="string" lcioOutType="ReconstructedParticle">HiggsPair</parameter>
        <parameter name="PreSelectionCollection" type="string" lcioOutType="ReconstructedParticle">PreSelectionHHvv</parameter>
        <parameter name="isPassed" type="string" lcioOutType="ReconstructedParticle">isPassedHHvv</parameter>
        <parameter name="JetCollectionName" type="string" lcioInType="ReconstructedParticle">RefinedJets</parameter>
        <parameter name="inputPfoCollection" type="string" lcioInType="ReconstructedParticle">PandoraPFOs</parameter>
        <!--Parameters for preselection -->
        <!--predefined preselection available for llbbbb, vvbbbb, and qqbbbb-->
        <parameter name="whichPreselection"> vvbbbb </parameter>
        <parameter name="ECM" type="float"> ${ECM} </parameter>

        <parameter name="outputFilename" type="string">${OutputDirectory}/${OutputBaseName}_PreSelection_vvHH.root</parameter>
        <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
        <parameter name="Verbosity" type="string">MESSAGE</parameter>
    </processor>

    <processor name="MyPreSelectionHHqq" type="PreSelection">
        <!--MyPreSelection identified events that have passed the preselection-->
        <!--Name of the input collections-->
        <parameter name="isolatedeptonCollection" type="string" lcioInType="ReconstructedParticle">ISOLeptons</parameter>
        <parameter name="LepPairCollection" type="string" lcioInType="ReconstructedParticle">LeptonPair</parameter>
        <parameter name="HiggsCollection" type="string" lcioOutType="ReconstructedParticle">HiggsPair</parameter>
        <parameter name="PreSelectionCollection" type="string" lcioOutType="ReconstructedParticle">PreSelectionHHqq</parameter>
        <parameter name="isPassed" type="string" lcioOutType="ReconstructedParticle">isPassedHHqq</parameter>
        <parameter name="JetCollectionName" type="string" lcioInType="ReconstructedParticle">RefinedJets</parameter>
        <parameter name="inputPfoCollection" type="string" lcioInType="ReconstructedParticle">PandoraPFOs</parameter>
        <!--Parameters for preselection -->
        <!--predefined preselection available for llbbbb, vvbbbb, and qqbbbb-->
        <parameter name="whichPreselection"> qqbbbb </parameter>
        <parameter name="ECM" type="float"> ${ECM} </parameter>

        <parameter name="outputFilename" type="string">${OutputDirectory}/${OutputBaseName}_PreSelection_qqHH.root</parameter>
        <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
        <parameter name="Verbosity" type="string">MESSAGE</parameter>
    </processor>

    <processor name="MyErrorFlow" type="ErrorFlow">
        <!--PfoAnalysis analyses output of PandoraPFANew-->
        <!--Names of input pfo collection-->
        <parameter name="InputPFOCollection" type="string" lcioInType="ReconstructedParticle">RefinedJets</parameter>
        <!--Names of output collection-->
        <parameter name="OutputPFOCollection" type="string" lcioOutType="ReconstructedParticle">OutputErrorFlowJets</parameter>
        <!--whether use full CovMat for neutral PFOs or use only energy uncertainty-->
        <parameter name="useFullCovMatforNeutrals" type="bool">true</parameter>
        <!--Enable/disable confusion term to be added to covariance matrix-->
        <parameter name="EnableConfusionTerm" type="bool">true</parameter>
        <!--Enable/disable Propagating uncertainty due to confusion to the Momentum components-->
        <parameter name="PropagateConfusion2Mom" type="bool">true</parameter>
        <!-- A correction factor to be multiplied to angular uncertainties of Photons -->
        <parameter name="CovMatFactorPhotons" type="double">1.3</parameter>
        <!-- A correction factor to be multiplied to angular uncertainties of Neutral Hadrons -->
        <parameter name="CovMatFactorNeutralHadrons" type="double">1.8</parameter>
        <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
        <parameter name="Verbosity" type="string">MESSAGE</parameter>
    </processor>

    <processor name="MyFinalStateRecorder" type="FinalStateRecorder">
        <!--MyFinalStateRecorder identified events that have passed the preselection-->
        <parameter name="MCParticleCollection" type="string" lcioInType="MCParticle">MCParticle</parameter>
        <parameter name="MCParticleCollectionNew" type="string" lcioInType="MCParticle">MCParticlesSkimmed</parameter>
        <parameter name="outputRootFilename" type="string">${OutputDirectory}/${OutputBaseName}_FinalStates.root</parameter>
        <parameter name="outputJsonFilename" type="string">${OutputDirectory}/${OutputBaseName}_FinalStateMeta.json</parameter>
        <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
        <parameter name="Verbosity" type="string">DEBUG</parameter>
    </processor>

    <processor name="MyLCIOOutputProcessor" type="LCIOOutputProcessor">
        <!--Writes the current event to the specified LCIO outputfile. Needs to be the last ActiveProcessor.-->
        <!--drops the named collections from the event-->
        <parameter name="DropCollectionNames" type="StringVec"> BuildUpVertex BuildUpVertex_RP BuildUpVertex_V0 BuildUpVertex_V0_RP GammaGammaCandidateEtaPrimes GammaGammaCandidateEtas GammaGammaCandidatePi0s MCTruthMarlinTrkTracksLink MCTruthClusterLink MarlinTrkTracks MarlinTrkTracksKaon MarlinTrkTracksMCTruthLink MarlinTrkTracksProton PFOsWithoutOverlay PandoraClusters PandoraPFO_updatedNeutralPFOs PandoraPFOsWithoutIsoLep PrimaryVertex PrimaryVertex_RP RefinedJets_rel RefinedJets_vtx RefinedJets_vtx_RP RefinedVertex_RP V0RecoParticles V0Vertices VertexJets DistilledPFOs GammaGammaParticles DurhamJetsPFOs Durham_2JetsPFOs PandoraPFOsWithoutLepPair </parameter>
        <!--drops all collections of the given type from the event-->
        <!--parameter name="DropCollectionTypes" type="StringVec">SimTrackerHit SimCalorimeterHit  </parameter-->
        <!-- write complete objects in subset collections to the file (i.e. ignore subset flag)-->
        <!--parameter name="FullSubsetCollections" type="StringVec">MCParticlesSkimmed  </parameter-->
        <!--force keep of the named collections - overrules DropCollectionTypes (and DropCollectionNames)-->
        <parameter name="KeepCollectionNames" type="StringVec"> FastJets4_Precluster Durham_2Jets IsolatedLeptons ISOLeptons PandoraPFOsWithoutLepPair RefinedJets RefinedJetsPFOs OutputErrorFlowJets TrueJets FinalColourNeutrals InitialColourNeutrals TrueJetPFOLink TrueJetMCParticleLink FinalElementonLink InitialElementonLink FinalColourNeutralLink InitialColourNeutralLink HdecayMode IsolatedLeptons preselection JetMatching </parameter>
        <!-- name of output file -->
        <parameter name="LCIOOutputFile" type="string">${OutputDirectory}/${OutputBaseName}.slcio</parameter>
        <!--write mode for output file:  WRITE_APPEND or WRITE_NEW-->
        <parameter name="LCIOWriteMode" type="string">WRITE_NEW</parameter>
        <!--will split output file if size in kB exceeds given value - doesn't work with APPEND and NEW-->
        <!--parameter name="SplitFileSizekB" type="int">1992294 </parameter-->
        <!--verbosity level of this processor ("DEBUG0-4,MESSAGE0-4,WARNING0-4,ERROR0-4,SILENT")-->
        <parameter name="Verbosity" type="string">DEBUG</parameter>
    </processor>
</marlin>
